{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Link,useLocation,useNavigate,useParams}from'react-router-dom';import{Form,Button,Row,Col}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import Loader from'../components/Loader';import Message from'../components/Message';import FormContainer from'../components/FormContainer';import{listProductDetails,updateProduct}from'../actions/productActions';import{PRODUCT_UPDATE_RESET}from'../constants/productConstants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProductEditScreen(){const{productId}=useParams();const[name,setName]=useState('');const[price,setPrice]=useState(0);const[image,setImage]=useState('');const[brand,setBrand]=useState('');const[category,setCategory]=useState('');const[countInStock,setCountInStock]=useState(0);const[description,setDescription]=useState('');const[uploading,setUploading]=useState(false);const navigate=useNavigate();const dispatch=useDispatch();const productDetails=useSelector(state=>state.productDetails);const{error,loading,product}=productDetails;const productUpdate=useSelector(state=>state.productUpdate);const{error:errorUpdate,loading:loadingUpdate,success:successUpdate}=productUpdate;useEffect(()=>{if(successUpdate){dispatch({type:PRODUCT_UPDATE_RESET});navigate('/admin/productlist');}else{if(!product.name||product._id!==Number(productId)){dispatch(listProductDetails(productId));}else{setName(product.name);setPrice(product.price);setImage(product.image);setBrand(product.brand);setCategory(product.category);setCountInStock(product.countInStock);setDescription(product.description);}}},[dispatch,product,productId,navigate,successUpdate]);const submitHandler=e=>{e.preventDefault();// Update product\ndispatch(updateProduct({_id:productId,name,price,image,brand,category,countInStock,description}));};const uploadFileHandler=async e=>{const file=e.target.files[0];const formData=new FormData();formData.append('image',file);formData.append('product_id',productId);setUploading(true);try{const config={headers:{'Content-Type':'multipart/form-data'}};const{data}=await axios.post('/api/products/upload',formData,config);setImage(data);setUploading(false);}catch(error){setUploading(false);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/admin/productlist\",children:\"Go Back\"}),/*#__PURE__*/_jsxs(FormContainer,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Edit User\"}),loadingUpdate&&/*#__PURE__*/_jsx(Loader,{}),errorUpdate&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorUpdate}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"name\",placeholder:\"Enter Name\",value:name,onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"price\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Enter Price\",value:price,onChange:e=>setPrice(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"image\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Image\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter Image\",value:image,onChange:e=>setImage(e.target.value)}),/*#__PURE__*/_jsx(Form.Control,{id:\"image-file\",type:\"file\",Label:\"Choose File\",custom:true,onChange:uploadFileHandler}),uploading&&/*#__PURE__*/_jsx(Loader,{})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"brand\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Brand\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter Brand\",value:brand,onChange:e=>setBrand(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"countinstock\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Stock\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Enter Stock\",value:countInStock,onChange:e=>setCountInStock(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"category\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Stock\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter Category\",value:category,onChange:e=>setCategory(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"description\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Description\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter Description\",value:description,onChange:e=>setDescription(e.target.value)})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Update\"})]})]})]});}export default ProductEditScreen;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}