{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useLocation,useNavigate}from'react-router-dom';import{Form,Button,Row,Col,Image,Card,ListGroup}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import Loader from'../components/Loader';import Message from'../components/Message';import{saveShippingAddress}from'../actions/cartActions';import CheckoutSteps from'../components/CheckoutSteps';import{createOrder}from'../actions/orderActions';import{ORDER_CREATE_RESET}from'../constants/orderConstants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function PlaceOrderScreen(){const orderCreate=useSelector(state=>state.orderCreate);const{order,error,success}=orderCreate;const navigate=useNavigate();const dispatch=useDispatch();const cart=useSelector(state=>state.cart);cart.itemsPrice=cart.cartItems.reduce((acc,item)=>acc+item.price*item.qty,0).toFixed(2);cart.shippingPrice=(cart.itemsPrice>100?0:10).toFixed(2);cart.taxPrice=(0.082*cart.itemsPrice).toFixed(2);cart.totalPrice=(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice)).toFixed(2);const placeOrder=()=>{dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));};useEffect(()=>{if(success){navigate(\"/order/\".concat(order._id));dispatch({type:ORDER_CREATE_RESET});}if(!cart.paymentMethod)navigate('/payment');},[success,navigate]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:8,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Shipping: \"}),cart.shippingAddress.address,\", \",cart.shippingAddress.city,' ',cart.shippingAddress.postalCode,\",\",' ',cart.shippingAddress.country,\",\"]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment method\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Method: \"}),cart.paymentMethod]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Items\"}),cart.cartItems.length===0?/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"Your cart is empty\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cart.cartItems.map((item,index)=>/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" X $\",item.price,\" = $\",(item.qty*item.price).toFixed(2)]})]})},index))})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Item:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Shipping:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.shippingPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Total:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.totalPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cart.cartItems===0,onClick:placeOrder,children:\"Place Order\"})})]})})})]})]});}export default PlaceOrderScreen;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}